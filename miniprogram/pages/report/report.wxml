<!-- pages/report/report.wxml -->
<view class="container">
  <!-- æŠ¥å‘Šå¡ç‰‡ -->
  <view class="report-card">
    <!-- æŠ¥å‘Šæ ‡é¢˜ -->
    <view class="report-header">
      <text class="report-title">å­¦ä¹ æŠ¥å‘Š</text>
      <text class="report-subtitle">ä½ çš„å­¦ä¹ æˆæœåˆ†æ</text>
    </view>
    
    <!-- æˆç»©æ¦‚è§ˆ -->
    <view class="score-overview">
      <view class="score-circle">
        <view class="score-inner">
          <text class="score-value">{{accuracy}}%</text>
          <text class="score-label">æ­£ç¡®ç‡</text>
        </view>
      </view>
      <view class="score-stats">
        <view class="score-stat-item">
          <text class="score-stat-value">{{totalQuestions}}</text>
          <text class="score-stat-label">æ€»é¢˜æ•°</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value correct">{{correctAnswers}}</text>
          <text class="score-stat-label">ç­”å¯¹é¢˜æ•°</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value wrong">{{totalQuestions - correctAnswers}}</text>
          <text class="score-stat-label">ç­”é”™é¢˜æ•°</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value">{{totalTime}}s</text>
          <text class="score-stat-label">æ€»è€—æ—¶</text>
        </view>
      </view>
    </view>
    
    <!-- å­¦ä¹ å»ºè®® -->
    <view class="suggestions-section" wx:if="{{learningSuggestions}}">
      <view class="section-header">
        <text class="section-title">å­¦ä¹ å»ºè®®</text>
        <view class="section-icon">{{learningSuggestions.icon}}</view>
      </view>
      <view class="suggestions-card" style="border-left-color: {{learningSuggestions.color}}">
        <view class="suggestions-header">
          <view class="suggestions-title-wrapper">
            <text class="suggestions-level" style="color: {{learningSuggestions.color}}">{{learningSuggestions.level}}</text>
            <text class="suggestions-title">{{learningSuggestions.title}}</text>
          </view>
          <view class="suggestions-progress-wrapper">
            <view class="suggestions-progress-bar">
              <view class="suggestions-progress-fill" style="width: {{learningSuggestions.progress}}%; background-color: {{learningSuggestions.color}}"></view>
            </view>
            <text class="suggestions-progress-text">{{learningSuggestions.progress}}%</text>
          </view>
        </view>
        <text class="suggestions-description">{{learningSuggestions.description}}</text>
        <view class="suggestions-tips">
          <view class="tips-title">
            <text class="tips-icon">ğŸ’¡</text>
            <text class="tips-title-text">å­¦ä¹ å»ºè®®</text>
          </view>
          <view class="tips-list">
            <view class="tip-item" wx:for="{{learningSuggestions.tips}}" wx:key="index" wx:for-item="tip">
              <view class="tip-icon" style="background-color: {{learningSuggestions.color}}20; color: {{learningSuggestions.color}}">
                <text class="tip-number">{{index + 1}}</text>
              </view>
              <text class="tip-text">{{tip}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ç­”é¢˜åˆ†å¸ƒ -->
    <view class="distribution-section">
      <view class="section-header">
        <text class="section-title">ç­”é¢˜åˆ†å¸ƒ</text>
        <view class="section-icon">ğŸ“Š</view>
      </view>
      <view class="distribution-chart">
        <view class="chart-bar correct-bar" style="width: {{accuracy}}%"></view>
        <view class="chart-bar wrong-bar" style="width: {{100 - accuracy}}%"></view>
      </view>
      <view class="distribution-legend">
        <view class="legend-item">
          <view class="legend-color correct"></view>
          <text class="legend-text">æ­£ç¡® ({{accuracy}}%)</text>
        </view>
        <view class="legend-item">
          <view class="legend-color wrong"></view>
          <text class="legend-text">é”™è¯¯ ({{100 - accuracy}}%)</text>
        </view>
      </view>
    </view>
    
    <!-- é”™é¢˜é›† -->
    <view class="wrong-questions-section">
      <view class="section-header">
        <text class="section-title">é”™é¢˜é›†</text>
        <view class="section-icon">ğŸ“</view>
      </view>
      <view class="wrong-questions-list">
        <view class="wrong-question" wx:if="{{wrongQuestions.length > 0}}" wx:for="{{wrongQuestions}}" wx:key="index">
          <view class="question-header">
            <text class="question-number">{{index + 1}}</text>
            <view class="question-text-wrapper">
              <scroll-view class="code-scroll-view" scroll-x="true" enable-flex="true">
                <rich-text class="question-text" nodes="{{item.questionHtml}}"></rich-text>
              </scroll-view>
            </view>
          </view>
          <view class="answer-info">
            <text class="answer-label">æ­£ç¡®ç­”æ¡ˆï¼š</text>
            <view class="correct-answer-wrapper">
              <scroll-view class="code-scroll-view" scroll-x="true" enable-flex="true">
                <rich-text class="correct-answer" nodes="{{item.correctAnswerHtml}}"></rich-text>
              </scroll-view>
            </view>
          </view>
          <view class="explanation-info" wx:if="{{item.explanationHtml}}">
            <text class="explanation-label">è¯¦ç»†è§£æï¼š</text>
            <view class="explanation-wrapper">
              <scroll-view class="code-scroll-view" scroll-x="true" enable-flex="true">
                <rich-text class="explanation-text" nodes="{{item.explanationHtml}}"></rich-text>
              </scroll-view>
            </view>
          </view>
        </view>
        <view class="no-wrong" wx:if="{{wrongQuestions.length === 0}}">
          <view class="no-wrong-icon">ğŸ‰</view>
          <text class="no-wrong-text">æ­å–œä½ ï¼Œæ²¡æœ‰é”™é¢˜ï¼</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æ“ä½œæŒ‰é’® -->
  <view class="button-group">
    <button class="btn restart-btn" bindtap="restartLearning">
      <view class="btn-content">
        <text class="btn-icon">ğŸ”„</text>
        <text class="btn-text">é‡æ–°å­¦ä¹ </text>
      </view>
    </button>
    <button class="btn home-btn" bindtap="goToHome">
      <view class="btn-content">
        <text class="btn-icon">ğŸ </text>
        <text class="btn-text">è¿”å›é¦–é¡µ</text>
      </view>
    </button>
  </view>
</view>