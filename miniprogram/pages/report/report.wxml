<!-- pages/report/report.wxml -->
<view class="container">
  <!-- 报告卡片 -->
  <view class="report-card">
    <!-- 报告标题 -->
    <view class="report-header">
      <text class="report-title">学习报告</text>
      <text class="report-subtitle">你的学习成果分析</text>
    </view>
    
    <!-- 成绩概览 -->
    <view class="score-overview">
      <view class="score-circle">
        <view class="score-inner">
          <text class="score-value">{{accuracy}}%</text>
          <text class="score-label">正确率</text>
        </view>
      </view>
      <view class="score-stats">
        <view class="score-stat-item">
          <text class="score-stat-value">{{totalQuestions}}</text>
          <text class="score-stat-label">总题数</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value correct">{{correctAnswers}}</text>
          <text class="score-stat-label">答对题数</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value wrong">{{totalQuestions - correctAnswers}}</text>
          <text class="score-stat-label">答错题数</text>
        </view>
        <view class="score-stat-item">
          <text class="score-stat-value">{{totalTime}}s</text>
          <text class="score-stat-label">总耗时</text>
        </view>
      </view>
    </view>
    
    <!-- 学习建议 -->
    <view class="suggestions-section">
      <view class="section-header">
        <text class="section-title">学习建议</text>
        <view class="section-icon">💡</view>
      </view>
      <view class="suggestions-card">
        <text class="suggestions">{{learningSuggestions}}</text>
      </view>
    </view>
    
    <!-- 答题分布 -->
    <view class="distribution-section">
      <view class="section-header">
        <text class="section-title">答题分布</text>
        <view class="section-icon">📊</view>
      </view>
      <view class="distribution-chart">
        <view class="chart-bar correct-bar" style="width: {{accuracy}}%"></view>
        <view class="chart-bar wrong-bar" style="width: {{100 - accuracy}}%"></view>
      </view>
      <view class="distribution-legend">
        <view class="legend-item">
          <view class="legend-color correct"></view>
          <text class="legend-text">正确 ({{accuracy}}%)</text>
        </view>
        <view class="legend-item">
          <view class="legend-color wrong"></view>
          <text class="legend-text">错误 ({{100 - accuracy}}%)</text>
        </view>
      </view>
    </view>
    
    <!-- 错题集 -->
    <view class="wrong-questions-section">
      <view class="section-header">
        <text class="section-title">错题集</text>
        <view class="section-icon">📝</view>
      </view>
      <view class="wrong-questions-list">
        <view class="wrong-question" wx:if="{{wrongQuestions.length > 0}}" wx:for="{{wrongQuestions}}" wx:key="index">
          <view class="question-header">
            <text class="question-number">{{index + 1}}</text>
            <view class="question-text-wrapper">
              <rich-text class="question-text" nodes="{{item.questionHtml}}"></rich-text>
            </view>
          </view>
          <view class="answer-info">
            <text class="answer-label">正确答案：</text>
            <view class="correct-answer-wrapper">
              <rich-text class="correct-answer" nodes="{{item.correctAnswerHtml}}"></rich-text>
            </view>
          </view>
          <view class="explanation-info" wx:if="{{item.explanationHtml}}">
            <text class="explanation-label">详细解析：</text>
            <view class="explanation-wrapper">
              <rich-text class="explanation-text" nodes="{{item.explanationHtml}}"></rich-text>
            </view>
          </view>
        </view>
        <view class="no-wrong" wx:if="{{wrongQuestions.length === 0}}">
          <view class="no-wrong-icon">🎉</view>
          <text class="no-wrong-text">恭喜你，没有错题！</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 操作按钮 -->
  <view class="button-group">
    <button class="btn restart-btn" bindtap="restartLearning">
      <view class="btn-content">
        <text class="btn-icon">🔄</text>
        <text class="btn-text">重新学习</text>
      </view>
    </button>
    <button class="btn home-btn" bindtap="goToHome">
      <view class="btn-content">
        <text class="btn-icon">🏠</text>
        <text class="btn-text">返回首页</text>
      </view>
    </button>
  </view>
</view>